%h2 Course Analytics Exports

%table.dynatable
  %thead
    %tr
      %th Generated By
      %th Filename
      %th Completed At
      %th Status
      %th
  %tbody
    - presenter.course_analytics_exports.each do |export|
      %tr
        -# generated by
        %td
          = link_to export.professor.name, user_path(export.professor)
        -# filename
        %td
          - if export.downloadable?
            = link_to export.export_filename, download_course_analytics_export_path(export)
          - else
            = export.export_filename
        -# completed_at timestamp
        %td
          = "#{time_ago_in_words(export.last_export_completed_at)} ago" if export.last_export_completed_at
        -# status
        %td
          - if export.last_export_completed_at
            = "Complete"
          - elsif export.created_at and not export.last_export_completed_at
            = "In Progress"
        -# buttons
        %td
          .right
            %ul.button-bar
              - if export.downloadable?
                %li= link_to glyph(:download) + "Download", download_course_analytics_export_path(export), class: 'button', style: "margin-right: 18px"
              %li= link_to glyph(:trash) + "Delete", export, class: 'button', data: { confirm: 'This will delete the course analytics export. Are you sure?' }, :method => :delete
