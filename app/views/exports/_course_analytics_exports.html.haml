%h2 Course Analytics Exports
%table.dynatable
  %thead
    %tr
      %th Generated By
      %th Filename
      %th Created
      %th Status
      %th
  %tbody
    -# @course_analytics_exports should be defined in a presenter so we don't
    -# have to use an instance variable here, but this is fine for now
    -#
    - presenter.course_analytics_exports.each do |export|
      %tr
        %td
          = link_to export.professor.name, user_path(export.professor)
        %td
          - if export.downloadable?
            = link_to export.export_filename, download_course_analytics_export_path(export)
          - else
            = export.export_filename
        %td
          = "#{time_ago_in_words(export.last_export_completed_at)} ago" if export.last_export_completed_at
        %td
          - if export.last_export_completed_at
            = "Complete"
          - elsif export.created_at and not export.last_export_completed_at
            = "In Progress"
        %td
          .right
            %ul.button-bar
              - if export.downloadable?
                %li= link_to glyph(:download) + "Download", download_course_analytics_export_path(export), class: 'button', style: "margin-right: 18px"
              %li= link_to glyph(:trash) + "Delete", export, class: 'button', data: { confirm: 'This will delete the course analytics export. Are you sure?' }, :method => :delete
